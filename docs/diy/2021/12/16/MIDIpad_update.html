<!DOCTYPE html>
<html lang="en">

  <head>
	<!-- Cookie Consent by TermsFeed (https://www.TermsFeed.com) -->
  <script type="text/javascript" src="https://www.termsfeed.com/public/cookie-consent/4.0.0/cookie-consent.js" charset="UTF-8"></script>
  <script type="text/javascript" charset="UTF-8">
  document.addEventListener('DOMContentLoaded', function () {
  cookieconsent.run({"notice_banner_type":"headline","consent_type":"express","palette":"dark","language":"en","page_load_consent_levels":["strictly-necessary"],"notice_banner_reject_button_hide":false,"preferences_center_close_button_hide":false,"page_refresh_confirmation_buttons":false,"website_privacy_policy_url":"https://blog.4dcu.be/policy/"});
  });
  </script>

	
  <!-- Google Analytics -->
    <script type="text/plain" cookie-consent="tracking" async src="https://www.googletagmanager.com/gtag/js?id=UA-47068418-5"></script>
    <script type="text/plain" cookie-consent="tracking">
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-47068418-5');
    </script>
  <!-- end of Google Analytics-->
	

  <noscript>ePrivacy and GPDR Cookie Consent by <a href="https://www.TermsFeed.com/" rel="nofollow">TermsFeed Generator</a></noscript>
  <!-- End Cookie Consent by TermsFeed (https://www.TermsFeed.com) -->

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Better Raspberry Pi Pico MIDI controller</title>
  <meta name="description" content="To expand the number of notes/chords my RP2040 based MIDI controller can play we’ll  turn two keys into modifiers. This way the other 7 buttons can actually ...">
  
  <meta name="author" content="Sebastian Proost">
  <meta name="copyright" content="&copy; Sebastian Proost 2022">
  

  <!-- External libraries -->
	<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="To expand the number of notes/chords my RP2040 based MIDI controller can play we’ll  turn two keys into modifiers. This way the other 7 buttons can actually ..." />
  <meta property="og:url" content="https://blog.4dcu.be/diy/2021/12/16/MIDIpad_update.html">
  <meta property="og:site_name" content="4DCu.be" />
  <meta property="og:title" content="Better Raspberry Pi Pico MIDI controller" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://blog.4dcu.be/assets/posts/2021-12-16-MIDIpad_update/midipad_button_mapping.jpg" />
  <meta property="og:image:type" content="image/jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Better Raspberry Pi Pico MIDI controller">
  <meta name="twitter:description" content="To expand the number of notes/chords my RP2040 based MIDI controller can play we’ll  turn two keys into modifiers. This way the other 7 buttons can actually ...">
  <meta name="twitter:image" content="https://blog.4dcu.be/assets/posts/2021-12-16-MIDIpad_update/midipad_button_mapping.jpg">
  <meta name="twitter:url" content="https://blog.4dcu.be/diy/2021/12/16/MIDIpad_update.html">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://blog.4dcu.be/diy/2021/12/16/MIDIpad_update.html">
	<link rel="alternate" type="application/rss+xml" title="4DCu.be" href="https://blog.4dcu.be/feed.xml" />
	
	<!-- Tooltips -->
	<script type="text/javascript">
		window.tooltips = []
	</script>

	<script type='text/javascript'>
	//<![CDATA[
	function loadCSS(e, t, n) { "use strict"; var i = window.document.createElement("link"); var o = t || window.document.getElementsByTagName("script")[0]; i.rel = "stylesheet"; i.href = e; i.media = "only x"; o.parentNode.insertBefore(i, o); setTimeout(function () { i.media = n || "all" }) }loadCSS("https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css");
	//]]>
	</Script>
</head>


  <body>

    <header class="navigation" role="banner">
	<div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/icons/apple-icon-76x76.png" alt="4DCu.be" width="58" height="58" />
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
				
				<li class="nav-link"><a href="/about/">About</a>
	
				<li class="nav-link"><a href="/gallery/">Gallery</a>
	
				<li class="nav-link"><a href="/posts/">Posts</a>
	
				<li class="nav-link"><a href="#" class="nav-link-contact">Contact</a></li>

      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/assets/posts/2021-12-16-MIDIpad_update/midipad_button_mapping.jpg);">
  <div class="scrim has-cover ">
    <header class="post-header">
      <h1 class="title">Better Raspberry Pi Pico MIDI controller</h1>
			
      <p class="info"><em>adding modifier keys and chord support</em></p>
			
    </header>
  </div>
</div>

<div class="wrapper">



<section class="post-meta">
  <div class="post-date">Posted December 16, 2021 by Sebastian Proost</div>
  <div class="post-categories">
  in 
    
    <a href="/category/diy">Diy</a>
    
  
  </div>
</section>

<article class="post-content">
  <p>To expand the number of notes/chords my RP2040 based <a href="/diy/2021/05/20/MIDIpad.html">MIDI controller</a> can play we’ll 
turn two keys into modifiers. This way the other 7 buttons can actually each be assigned 4 different notes/chords (a default,
pressed with modifier one, pressed with modifier two and pressed with both modifiers active). So we go from 9 notes/chords to 
28 different options, which should expand the number of songs that can be played substantially.</p>

<p>While at first glance this seems like an easy task, there are a few things that need to be taken into consideration. A
MIDI device sends a signal once a note is pressed and one when it is released. In the previous post this was straightforward; each
button was playing two notes one octave apart, and there was no overlap between buttons. So when a button goes down, 
the corresponding notes can start, if that button goes up those notes can be started again, easy …</p>

<p><a href="/assets/posts/2021-12-16-MIDIpad_update/midipad_button_mapping.jpg" class="lightgallery-link" data-sub-html="New each button maps to 4 chords, depending on which modifiers are pressed">
<img src="/assets/posts/2021-12-16-MIDIpad_update/midipad_button_mapping.jpg" alt="New each button maps to 4 chords, depending on which modifiers are pressed" data-src="/assets/posts/2021-12-16-MIDIpad_update/midipad_button_mapping.jpg" loading="lazy" />
</a></p>

<p>When assigning proper chords to buttons, things get more complex. Imagine a key that plays a C chord, once pressed a signal
is sent to play notes C, E and G. If that key is released a signal to stop those notes is needed. However, if another 
key playing an E chord (E-G#-Bb) is pressed without releasing the former, there is an overlapping note. So 
releasing the C chord button should <strong>not</strong> stop playing the E note. To do this we need to keep track of a few things: 
which modifiers were active when a button was pressed and which notes are currently playing. That way we can figure 
out at any given time which notes should be playing and which need to be stopped. This is a bit of extra overhead, 
fortunately the RP2040 chip has plenty of power to do this without much issue.</p>

<p>How to build the keypad is discussed <a href="/diy/2021/04/05/Macropad.html">here</a>. This post includes a part list, 
all schematics you’ll need along with STL files for the 3D printed parts. If you are new to MIDI devices you might want
to start with the <a href="/diy/2021/05/20/MIDIpad.html">previous post</a> as this is an easier starting point.</p>

<h2 id="midipad-v20---the-code">MIDIPad v2.0 - the code</h2>

<p>Here is the full code which can also be downloaded <a href="./assets/posts/2021-12-16-MIDIpad_update/midapad_2.py">here</a>. Note that this is intended to work with <a href="https://circuitpython.readthedocs.io/">CircuitPython</a> 
and requires the <a href="https://github.com/adafruit/Adafruit_CircuitPython_MIDI">AdaFruit MIDI</a> library to be installed on the device. Below the code some major changes will
be highlighted. This file needs to be renamed to <code class="language-plaintext highlighter-rouge">code.py</code> and put in the root directory of the Pi Pico.</p>

<div class="language-python large-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">board</span>
<span class="kn">import</span> <span class="nn">digitalio</span>
<span class="kn">import</span> <span class="nn">pwmio</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="kn">import</span> <span class="nn">usb_midi</span>
<span class="kn">import</span> <span class="nn">adafruit_midi</span>

<span class="kn">from</span> <span class="nn">adafruit_midi.note_on</span> <span class="kn">import</span> <span class="n">NoteOn</span>
<span class="kn">from</span> <span class="nn">adafruit_midi.note_off</span> <span class="kn">import</span> <span class="n">NoteOff</span>


<span class="n">midi</span> <span class="o">=</span> <span class="n">adafruit_midi</span><span class="p">.</span><span class="n">MIDI</span><span class="p">(</span><span class="n">midi_out</span><span class="o">=</span><span class="n">usb_midi</span><span class="p">.</span><span class="n">ports</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">out_channel</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"MacroPad MIDI Board"</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="s">"Default output MIDI channel:"</span><span class="p">,</span> <span class="n">midi</span><span class="p">.</span><span class="n">out_channel</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="c1"># Configuration, which LED pins are used, which buttons, how buttons map to notes
</span><span class="n">led_pins</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">.</span><span class="n">GP18</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP17</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP16</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP21</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP20</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP19</span><span class="p">,</span> <span class="n">board</span><span class="p">.</span><span class="n">GP27</span><span class="p">,</span> <span class="n">board</span><span class="p">.</span><span class="n">GP26</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP22</span><span class="p">]</span>
<span class="n">button_pins</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">.</span><span class="n">GP13</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP14</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP15</span><span class="p">,</span> <span class="n">board</span><span class="p">.</span><span class="n">GP10</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP11</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP12</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP7</span><span class="p">]</span>
<span class="n">button_led_ix</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>

<span class="n">modifier_pins</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">.</span><span class="n">GP8</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP9</span><span class="p">]</span>
<span class="n">modifier_led_ix</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>

<span class="n">note_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Notes when no modifier is pressed (major chord)
</span>    <span class="mi">0</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">"C3"</span><span class="p">,</span> <span class="s">"E3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"D3"</span><span class="p">,</span> <span class="s">"F#3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"E3"</span><span class="p">,</span> <span class="s">"G#3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"F3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"G3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"A3"</span><span class="p">,</span> <span class="s">"C#4"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"B3"</span><span class="p">,</span> <span class="s">"D#4"</span><span class="p">,</span> <span class="s">"F#4"</span><span class="p">]],</span>
    <span class="c1"># Notes when modifier one is pressed (minor chords)
</span>    <span class="mi">1</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">"C3"</span><span class="p">,</span> <span class="s">"Eb3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"D3"</span><span class="p">,</span> <span class="s">"F3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"E3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"F3"</span><span class="p">,</span> <span class="s">"Ab3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"G3"</span><span class="p">,</span> <span class="s">"Bb3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"A3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"B3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">,</span> <span class="s">"F#4"</span><span class="p">]],</span>
    <span class="c1"># Notes when modifier two is pressed (sus2 chords)
</span>    <span class="mi">2</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">"C3"</span><span class="p">,</span> <span class="s">"D3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"D3"</span><span class="p">,</span> <span class="s">"E3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"E3"</span><span class="p">,</span> <span class="s">"F#3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"F3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"G3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"A3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"B3"</span><span class="p">,</span> <span class="s">"C#4"</span><span class="p">,</span> <span class="s">"F#4"</span><span class="p">]],</span>
    <span class="c1"># Notes when both modifiers are pressed (sus4 chords)
</span>    <span class="mi">3</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">"C3"</span><span class="p">,</span> <span class="s">"F3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"D3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"E3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"F3"</span><span class="p">,</span> <span class="s">"A#3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"G3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"A3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"B3"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">,</span> <span class="s">"F#4"</span><span class="p">]]</span>
    <span class="p">}</span>
    

<span class="c1"># Set up buttons
</span><span class="n">buttons</span> <span class="o">=</span> <span class="p">[</span><span class="n">digitalio</span><span class="p">.</span><span class="n">DigitalInOut</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span> <span class="k">for</span> <span class="n">bp</span> <span class="ow">in</span> <span class="n">button_pins</span><span class="p">]</span>

<span class="k">for</span> <span class="n">btn</span> <span class="ow">in</span> <span class="n">buttons</span><span class="p">:</span>
    <span class="n">btn</span><span class="p">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">digitalio</span><span class="p">.</span><span class="n">Direction</span><span class="p">.</span><span class="n">INPUT</span>
    <span class="n">btn</span><span class="p">.</span><span class="n">pull</span> <span class="o">=</span> <span class="n">digitalio</span><span class="p">.</span><span class="n">Pull</span><span class="p">.</span><span class="n">UP</span>

<span class="n">modifiers</span> <span class="o">=</span> <span class="p">[</span><span class="n">digitalio</span><span class="p">.</span><span class="n">DigitalInOut</span><span class="p">(</span><span class="n">bp</span><span class="p">)</span> <span class="k">for</span> <span class="n">bp</span> <span class="ow">in</span> <span class="n">modifier_pins</span><span class="p">]</span>

<span class="k">for</span> <span class="n">modif</span> <span class="ow">in</span> <span class="n">modifiers</span><span class="p">:</span>
    <span class="n">modif</span><span class="p">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">digitalio</span><span class="p">.</span><span class="n">Direction</span><span class="p">.</span><span class="n">INPUT</span>
    <span class="n">modif</span><span class="p">.</span><span class="n">pull</span> <span class="o">=</span> <span class="n">digitalio</span><span class="p">.</span><span class="n">Pull</span><span class="p">.</span><span class="n">UP</span>

<span class="c1"># Set up LEDs
</span><span class="n">leds</span> <span class="o">=</span> <span class="p">[</span><span class="n">pwmio</span><span class="p">.</span><span class="n">PWMOut</span><span class="p">(</span><span class="n">lp</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">duty_cycle</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">lp</span> <span class="ow">in</span> <span class="n">led_pins</span><span class="p">]</span>

<span class="c1"># Set Initial Duty Cycles to 0 for each LED
</span><span class="n">duty_cycles</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">led_pins</span><span class="p">]</span>

<span class="c1"># Last Pressed
</span><span class="n">pressed_keys</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">button_pins</span><span class="p">]</span>
<span class="n">triggered_keys</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">button_pins</span><span class="p">]</span>

<span class="n">pressed_modifiers</span> <span class="o">=</span> <span class="p">[</span><span class="bp">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">modifier_pins</span><span class="p">]</span>

<span class="c1"># Notes playing
</span><span class="n">notes_playing</span> <span class="o">=</span> <span class="p">[]</span>


<span class="k">print</span><span class="p">(</span><span class="s">"started loop"</span><span class="p">)</span>
<span class="k">while</span> <span class="bp">True</span><span class="p">:</span>
    <span class="c1"># Handle modifier buttons
</span>    <span class="n">modifier_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="p">(</span><span class="n">led_ix</span><span class="p">,</span> <span class="n">modif</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">modifier_led_ix</span><span class="p">,</span> <span class="n">modifiers</span><span class="p">)):</span>
        <span class="n">pressed_modifiers</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">modif</span><span class="p">.</span><span class="n">value</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">modif</span><span class="p">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">modifier_value</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">ix</span>
            <span class="c1"># print(f"pressed modifier {ix}")
</span>            <span class="c1"># print(f"current modifier {modifier_value}")
</span>            <span class="n">duty_cycles</span><span class="p">[</span><span class="n">led_ix</span><span class="p">]</span> <span class="o">=</span> <span class="mi">65025</span>
    
    <span class="c1"># Handle buttons pressed
</span>    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="p">(</span><span class="n">led_ix</span><span class="p">,</span> <span class="n">btn</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">button_led_ix</span><span class="p">,</span> <span class="n">buttons</span><span class="p">)):</span>
        <span class="n">pressed_keys</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">btn</span><span class="p">.</span><span class="n">value</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">btn</span><span class="p">.</span><span class="n">value</span><span class="p">:</span>
            <span class="c1"># print(f"pressed button {ix}")
</span>            <span class="n">duty_cycles</span><span class="p">[</span><span class="n">led_ix</span><span class="p">]</span> <span class="o">=</span> <span class="mi">65025</span>
            
    
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="p">(</span><span class="n">pk</span><span class="p">,</span> <span class="n">tk</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">,</span> <span class="n">triggered_keys</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">pk</span> <span class="ow">and</span> <span class="n">tk</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"note </span><span class="si">{</span><span class="n">ix</span><span class="si">}</span><span class="s"> started with modifier </span><span class="si">{</span><span class="n">modifier_value</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="n">triggered_keys</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">modifier_value</span>
            <span class="c1"># Start all notes in the chord
</span>            <span class="n">midi</span><span class="p">.</span><span class="n">send</span><span class="p">([</span><span class="n">NoteOn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">note_mapping</span><span class="p">[</span><span class="n">modifier_value</span><span class="p">][</span><span class="n">ix</span><span class="p">]])</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">note_mapping</span><span class="p">[</span><span class="n">modifier_value</span><span class="p">][</span><span class="n">ix</span><span class="p">]:</span>
                <span class="n">notes_playing</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">pk</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tk</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"note </span><span class="si">{</span><span class="n">ix</span><span class="si">}</span><span class="s"> stopped"</span><span class="p">)</span>
            <span class="n">triggered_keys</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
     
    <span class="c1"># Check which notes/chords are currently playing after handling buttons
</span>    <span class="n">notes_playing_updated</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">tk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">triggered_keys</span><span class="p">):</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tk</span><span class="p">:</span>
            <span class="n">notes_playing_updated</span> <span class="o">=</span> <span class="n">notes_playing_updated</span> <span class="o">+</span> <span class="n">note_mapping</span><span class="p">[</span><span class="n">tk</span><span class="p">][</span><span class="n">ix</span><span class="p">]</span>
    
    <span class="c1"># Stop notes no longer playing
</span>    <span class="n">notes_to_stop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">notes_playing</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">notes_playing_updated</span><span class="p">)</span>
    <span class="n">midi</span><span class="p">.</span><span class="n">send</span><span class="p">([</span><span class="n">NoteOff</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">notes_to_stop</span><span class="p">])</span>
    
    <span class="c1"># Move updated list to notes_playing for next cycle
</span>    <span class="n">notes_playing</span> <span class="o">=</span> <span class="n">notes_playing_updated</span>
    
    <span class="c1"># Fade effect on LEDs 
</span>    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">led</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">leds</span><span class="p">):</span>
        <span class="n">led</span><span class="p">.</span><span class="n">duty_cycle</span> <span class="o">=</span> <span class="n">duty_cycles</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span>
        <span class="n">duty_cycles</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">duty_cycles</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">-</span> <span class="mi">900</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="n">time</span><span class="p">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
</code></pre></div></div>

<h2 id="adding-in-modifier-keys">Adding in modifier keys</h2>

<p>Two buttons have been used as modifier keys, in the program logic these are now handled differently from regular 
buttons that will play some notes. There are additional changes required to make sure we can still match the right
LED to each button correctly. So to do this, a list of pins with buttons is defined as well as a list of the index of
the matching LED. The same is done for the modifier buttons.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Configuration, which LED pins are used, which buttons, how buttons map to notes
</span><span class="n">led_pins</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">.</span><span class="n">GP18</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP17</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP16</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP21</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP20</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP19</span><span class="p">,</span> <span class="n">board</span><span class="p">.</span><span class="n">GP27</span><span class="p">,</span> <span class="n">board</span><span class="p">.</span><span class="n">GP26</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP22</span><span class="p">]</span>
<span class="n">button_pins</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">.</span><span class="n">GP13</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP14</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP15</span><span class="p">,</span> <span class="n">board</span><span class="p">.</span><span class="n">GP10</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP11</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP12</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP7</span><span class="p">]</span>
<span class="n">button_led_ix</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>

<span class="n">modifier_pins</span> <span class="o">=</span> <span class="p">[</span><span class="n">board</span><span class="p">.</span><span class="n">GP8</span><span class="p">,</span><span class="n">board</span><span class="p">.</span><span class="n">GP9</span><span class="p">]</span>
<span class="n">modifier_led_ix</span> <span class="o">=</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</code></pre></div></div>

<p>To accommodate these changes, additional changes throughout the code were necessary. Nothing to complicated, the 
modifier buttons need to be set up separately and when changing the duty cycle for a specific LED, the index from
either <code class="language-plaintext highlighter-rouge">button_led_ix</code> or <code class="language-plaintext highlighter-rouge">modifier_led_ix</code> as there is no longer a 1-to-1 mapping of keys and LEDs.</p>

<p>The modifier keys itself include an old trick. Essentially each modifier key is assigned a value which is
a power of two, so the first on is 1 (2^0), the next 2 (2^1), then 4 (2^2), … that way if we add the values of all 
pressed modifiers together you get a unique number for each possible combination. Here only two buttons are available
so the modifier value can be 0 (no modifier), 1 (first button pressed), 2 (second button pressed) or 3 (both buttons 
pressed). This is done in the bit of code below and is the first step of the main loop.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="c1"># Handle modifier buttons
</span>    <span class="n">modifier_value</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="p">(</span><span class="n">led_ix</span><span class="p">,</span> <span class="n">modif</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">modifier_led_ix</span><span class="p">,</span> <span class="n">modifiers</span><span class="p">)):</span>
        <span class="n">pressed_modifiers</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">modif</span><span class="p">.</span><span class="n">value</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">modif</span><span class="p">.</span><span class="n">value</span><span class="p">:</span>
            <span class="n">modifier_value</span> <span class="o">+=</span> <span class="mi">2</span> <span class="o">**</span> <span class="n">ix</span>
            <span class="c1"># print(f"pressed modifier {ix}")
</span>            <span class="c1"># print(f"current modifier {modifier_value}")
</span>            <span class="n">duty_cycles</span><span class="p">[</span><span class="n">led_ix</span><span class="p">]</span> <span class="o">=</span> <span class="mi">65025</span>
</code></pre></div></div>

<h2 id="playing-chords">Playing chords</h2>

<p>The biggest hurdle with playing chords is that notes within different chords can overlap. So the logic to start and stop
playing certain notes needed to be upgraded.</p>

<p>In the previous version we tracked which keys were pressed (so we could release them correctly) and if the notes 
associated with that key were playing already (or triggered). Now we’ll need to keep track of which modifiers were 
active when a key is triggered. So rather than using boolean logic we’ll set the trigger to -1 (not triggered) or the
modifier value (0-3) if a button is pressed.</p>

<div class="language-python large-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="p">(</span><span class="n">pk</span><span class="p">,</span> <span class="n">tk</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">pressed_keys</span><span class="p">,</span> <span class="n">triggered_keys</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">pk</span> <span class="ow">and</span> <span class="n">tk</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"note </span><span class="si">{</span><span class="n">ix</span><span class="si">}</span><span class="s"> started with modifier </span><span class="si">{</span><span class="n">modifier_value</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
            <span class="n">triggered_keys</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">modifier_value</span>
            <span class="c1"># Start all notes in the chord
</span>            <span class="n">midi</span><span class="p">.</span><span class="n">send</span><span class="p">([</span><span class="n">NoteOn</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">60</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">note_mapping</span><span class="p">[</span><span class="n">modifier_value</span><span class="p">][</span><span class="n">ix</span><span class="p">]])</span>
            <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">note_mapping</span><span class="p">[</span><span class="n">modifier_value</span><span class="p">][</span><span class="n">ix</span><span class="p">]:</span>
                <span class="n">notes_playing</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="n">pk</span> <span class="ow">and</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tk</span><span class="p">:</span>
            <span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"note </span><span class="si">{</span><span class="n">ix</span><span class="si">}</span><span class="s"> stopped"</span><span class="p">)</span>
            <span class="n">triggered_keys</span><span class="p">[</span><span class="n">ix</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
     
    <span class="c1"># Check which notes/chords are currently playing after handling buttons
</span>    <span class="n">notes_playing_updated</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">tk</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">triggered_keys</span><span class="p">):</span>
        <span class="k">if</span> <span class="mi">0</span> <span class="o">&lt;=</span> <span class="n">tk</span><span class="p">:</span>
            <span class="n">notes_playing_updated</span> <span class="o">=</span> <span class="n">notes_playing_updated</span> <span class="o">+</span> <span class="n">note_mapping</span><span class="p">[</span><span class="n">tk</span><span class="p">][</span><span class="n">ix</span><span class="p">]</span>
    
    <span class="c1"># Stop notes no longer playing
</span>    <span class="n">notes_to_stop</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">notes_playing</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">notes_playing_updated</span><span class="p">)</span>
    <span class="n">midi</span><span class="p">.</span><span class="n">send</span><span class="p">([</span><span class="n">NoteOff</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">notes_to_stop</span><span class="p">])</span>
    
    <span class="c1"># Move updated list to notes_playing for next cycle
</span>    <span class="n">notes_playing</span> <span class="o">=</span> <span class="n">notes_playing_updated</span>
</code></pre></div></div>

<h2 id="which-chords-to-pick--and-how-to-define-them-">Which chords to pick ? And how to define them ?</h2>

<p>The short answer is, you add in the chords you need. I picked from a major scale the major chords (C, D, E, F, G, A 
and B) and modifiers can be used to turn these into minor chords, sus2 chords or sus4 chords. These are defined in
a dictionary in the beginning of the code called <code class="language-plaintext highlighter-rouge">note_mapping</code>, the key is the modifier which is active and the
value is a list of chords matching the buttons defined.</p>

<p>Note that it is extremely easy to modify the chords to match your preferences. Simply add/remove/change notes to 
this list and done!</p>

<div class="language-python large-code highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">note_mapping</span> <span class="o">=</span> <span class="p">{</span>
    <span class="c1"># Notes when no modifier is pressed (major chord)
</span>    <span class="mi">0</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">"C3"</span><span class="p">,</span> <span class="s">"E3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"D3"</span><span class="p">,</span> <span class="s">"F#3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"E3"</span><span class="p">,</span> <span class="s">"G#3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"F3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"G3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"A3"</span><span class="p">,</span> <span class="s">"C#4"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"B3"</span><span class="p">,</span> <span class="s">"D#4"</span><span class="p">,</span> <span class="s">"F#4"</span><span class="p">]],</span>
    <span class="c1"># Notes when modifier one is pressed (minor chords)
</span>    <span class="mi">1</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">"C3"</span><span class="p">,</span> <span class="s">"Eb3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"D3"</span><span class="p">,</span> <span class="s">"F3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"E3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"F3"</span><span class="p">,</span> <span class="s">"Ab3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"G3"</span><span class="p">,</span> <span class="s">"Bb3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"A3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"B3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">,</span> <span class="s">"F#4"</span><span class="p">]],</span>
    <span class="c1"># Notes when modifier two is pressed (sus2 chords)
</span>    <span class="mi">2</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">"C3"</span><span class="p">,</span> <span class="s">"D3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"D3"</span><span class="p">,</span> <span class="s">"E3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"E3"</span><span class="p">,</span> <span class="s">"F#3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"F3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"G3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"A3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"B3"</span><span class="p">,</span> <span class="s">"C#4"</span><span class="p">,</span> <span class="s">"F#4"</span><span class="p">]],</span>
    <span class="c1"># Notes when both modifiers are pressed (sus4 chords)
</span>    <span class="mi">3</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">[</span><span class="s">"C3"</span><span class="p">,</span> <span class="s">"F3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"D3"</span><span class="p">,</span> <span class="s">"G3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"E3"</span><span class="p">,</span> <span class="s">"A3"</span><span class="p">,</span> <span class="s">"B3"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"F3"</span><span class="p">,</span> <span class="s">"A#3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"G3"</span><span class="p">,</span> <span class="s">"C4"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"A3"</span><span class="p">,</span> <span class="s">"D4"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">],</span>
        <span class="p">[</span><span class="s">"B3"</span><span class="p">,</span> <span class="s">"E4"</span><span class="p">,</span> <span class="s">"F#4"</span><span class="p">]]</span>
    <span class="p">}</span>
</code></pre></div></div>

<h2 id="conclusion">Conclusion</h2>

<p>The MIDIpad now can play 28 different chords, which is a substantial increase for the 9 from the last version. Also
overlapping notes between chords are now handled correctly. So with a little extra effort the little keypad suddenly
gained a few new tricks. Though there is still an issue with using normal switches, they don’t detect how hard a note
is pressed … This is still something I’d like so solve in a future post!</p>


</article>



<section class="tags">
	<strong><i class="fa fa-tags"></i> Tags:</strong> <a href="/tag/raspberry-pi">raspberry-pi</a>,&nbsp;<a href="/tag/python">python</a>,&nbsp;<a href="/tag/mechanical-keyboard">mechanical-keyboard</a>,&nbsp;<a href="/tag/soldering">soldering</a>,&nbsp;<a href="/tag/electronics">electronics</a>,&nbsp;<a href="/tag/midi">midi</a>
</section>



<section class="rss">
	
	<p class="rss-subscribe text">Liked this post ? <strong><a href="https://buymeacoffee.com/4dcube">You can buy me a coffee <i class="fa fa-coffee"></i></a></strong></p>
	
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=Better+Raspberry+Pi+Pico+MIDI+controller&url=https%3A%2F%2Fblog.4dcu.be%2Fdiy%2F2021%2F12%2F16%2FMIDIpad_update.html&via=ProostSebastian"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=Better+Raspberry+Pi+Pico+MIDI+controller&u=https%3A%2F%2Fblog.4dcu.be%2Fdiy%2F2021%2F12%2F16%2FMIDIpad_update.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
      <a href="//www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.4dcu.be%2Fdiy%2F2021%2F12%2F16%2FMIDIpad_update.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
        <i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
    
    
    
  
</section>

	<section class="post-navigation">
		<span class="prev-post">
			
				<a href="/programming/biology/2021/11/11/Clustering-penguins_2.html">
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-left fa-stack-1x fa-inverse"></i>
					</span>
					<span class="page-number">Faster Mixture Models in PyMC3</span>
				</a>
			
		</span>
		<span class="next-post">
			
				<a href="/programming/2021/12/30/Posthoc-Statannotations.html">
					<span class="page-number">Plotting post hoc tests with Python</span>
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-right fa-stack-1x fa-inverse"></i>
					</span>
				</a>
			
		</span>
	</section>




<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript" cookie-consent="functionality">
    var disqus_shortname = '4dcube';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

		<div class="modal micromodal-slide" id="modal-1" aria-hidden="true">
	<div class="modal__overlay" tabindex="-1" data-micromodal-close>
		<div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
			<header class="modal__header">
				<h2 class="modal__title" id="modal-1-title">
					Contact
				</h2>
			</header>
			<main class="modal__content" id="modal-1-content">
				<p>Have any comments or suggestions, your are welcome to reach out !</p>
				<ul class="modal__list">
						<li>
	<i class="fa fa-envelope-o"></i>
	<a href="mailto:sebastian.proost@gmail.com">
		<span class="username">sebastian.proost@gmail.com</span>
	</a>
</li>


	
	<li>
		<i class="fa fa-twitter"></i>
		<a href="https://twitter.com/ProostSebastian" title="Follow me on Twitter">
			<span class="username">ProostSebastian</span>
		</a>
	</li>
	

	
	<li>
		<i class="fa fa-github"></i>
		<a href="https://github.com/4dcu-be" title="Fork me on GitHub">
			<span class="username">4dcu-be</span>
		</a>
	</li>
	

	
	<li>
		<i class="fa fa-github"></i>
		<a href="https://github.com/sepro" title="Fork me on GitHub">
			<span class="username">sepro</span>
		</a>
	</li>
	

	

	


				</ul>
				
				<br />
				<p>Do you like this blog and wish to contribute? You could <a href="https://buymeacoffee.com/4dcube">Buy me a Coffee <i class="fa fa-coffee"></i></a>!</p>
				
			</main>
			<footer class="modal__footer">
				<button class="modal__btn modal__btn-primary" data-micromodal-close="" aria-label="Close this dialog window">Close</button>
			</footer>
		</div>
	</div>
</div>


    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">4DCu.be</h3>

		<div>
			<div class="site-navigation">

				<p><strong>Site Map</strong></p>
				<ul class="pages">
					
				<li class="nav-link"><a href="/about/">About</a>
	
				<li class="nav-link"><a href="/gallery/">Gallery</a>
	
				<li class="nav-link"><a href="/posts/">Posts</a>
	
				<li class="nav-link"><a href="#" class="nav-link-contact">Contact</a></li>

				</ul>
				<br />
				<p><strong>Legal</strong></p>
				<p><a href="/policy/">Privacy policy</a></p>
			</div>

			<div class="site-contact">
				<p><strong>Contact</strong></p>
				<ul class="social-media-list">
					<li>
	<i class="fa fa-envelope-o"></i>
	<a href="mailto:sebastian.proost@gmail.com">
		<span class="username">sebastian.proost@gmail.com</span>
	</a>
</li>


	
	<li>
		<i class="fa fa-twitter"></i>
		<a href="https://twitter.com/ProostSebastian" title="Follow me on Twitter">
			<span class="username">ProostSebastian</span>
		</a>
	</li>
	

	
	<li>
		<i class="fa fa-github"></i>
		<a href="https://github.com/4dcu-be" title="Fork me on GitHub">
			<span class="username">4dcu-be</span>
		</a>
	</li>
	

	
	<li>
		<i class="fa fa-github"></i>
		<a href="https://github.com/sepro" title="Fork me on GitHub">
			<span class="username">sepro</span>
		</a>
	</li>
	

	

	


				</ul>
			</div>

			<div class="site-signature">
				
				<p><strong>Contribute</strong></p>
				<p><i class="fa fa-coffee"></i> <a href="https://buymeacoffee.com/4dcube">Buy me a Coffee </a></p>
				
				<p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
				
			</div>
		</div>


  </div>

</footer>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/lightgallery.min.js"></script>
<script src="https://unpkg.com/micromodal/dist/micromodal.min.js"></script>
<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script type="text/javascript">
window.MathJax = {
  options: {
    enableMenu: false
  },
  tex: {
    packages: ['base', 'ams']
  },
  loader: {
    load: ['ui/menu', '[tex]/ams']
  }
};
</script>
<script type="text/javascript" id="MathJax-script"
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.min.js">
</script>
<script>
	AOS.init({
   once: true,
   offset: -20,
   duration: 600
	});
</script>


<script type="text/javascript">
$(document).ready(function() {
  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });

});

</script>
<script type="text/javascript">
$(document).ready(function() {
		$(".post-content").lightGallery({
			 thumbnail:false,
			 selector: '.lightgallery-link'
		});
});
</script>

<!-- Contact Modal -->
<script type="text/javascript">
$(document).ready(function() {
	MicroModal.init();

	$('.nav-link-contact').click(function(ev) {
	  ev.preventDefault();
	  MicroModal.show('modal-1', {
	  		onClose: function() { $('.nav-link-contact').blur(); },
	  		disableFocus: true
	  });
	});

});
</script>






  </body>

</html>
