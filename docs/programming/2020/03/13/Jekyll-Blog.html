<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Improving blogs with custom Jekyll Plugins</title>
  <meta name="description" content="This blog is built using Jekyll, which can be used to generate a static website based on a set of templates (for the layout) and markdown files (for the cont...">
  
  <meta name="author" content="Sebastian Proost">
  <meta name="copyright" content="&copy; Sebastian Proost 2021">
  

  <!-- External libraries -->
  <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://unpkg.com/aos@next/dist/aos.css" />

  <!-- Favicon and other icons (made with http://www.favicon-generator.org/) -->
  <link rel="shortcut icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/assets/icons/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" sizes="57x57" href="/assets/icons/apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="/assets/icons/apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="/assets/icons/apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="/assets/icons/apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="/assets/icons/apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="/assets/icons/apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="/assets/icons/apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="/assets/icons/android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="/assets/icons/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png">
  <link rel="manifest" href="/assets/icons/manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="/assets/icons/ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">

  
  <!-- Facebook OGP cards -->
  <meta property="og:description" content="This blog is built using Jekyll, which can be used to generate a static website based on a set of templates (for the layout) and markdown files (for the cont..." />
  <meta property="og:url" content="https://blog.4dcu.be/programming/2020/03/13/Jekyll-Blog.html">
  <meta property="og:site_name" content="4DCu.be" />
  <meta property="og:title" content="Improving blogs with custom Jekyll Plugins" />
  <meta property="og:type" content="website" />
  <meta property="og:image" content="https://blog.4dcu.be/assets/posts/2020-03-13-Jekyll-Blog/map_extension.png" />
  <meta property="og:image:type" content="image/jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  

  
  <!-- Twitter: card tags -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="Improving blogs with custom Jekyll Plugins">
  <meta name="twitter:description" content="This blog is built using Jekyll, which can be used to generate a static website based on a set of templates (for the layout) and markdown files (for the cont...">
  <meta name="twitter:image" content="https://blog.4dcu.be/assets/posts/2020-03-13-Jekyll-Blog/map_extension.png">
  <meta name="twitter:url" content="https://blog.4dcu.be/programming/2020/03/13/Jekyll-Blog.html">
  

  

  <!-- Site styles -->
  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="https://blog.4dcu.be/programming/2020/03/13/Jekyll-Blog.html">
	<link rel="alternate" type="application/rss+xml" title="4DCu.be" href="https://blog.4dcu.be/feed.xml" />
	
	<!-- Tooltips -->
	<script type="text/javascript">
		window.tooltips = []
	</script>
</head>


  <body>

    <header class="navigation" role="banner">
  <div class="navigation-wrapper">
    <a href="/" class="logo">
      
      <img src="/assets/icons/apple-icon-76x76.png" alt="4DCu.be">
      
    </a>
    <a href="javascript:void(0)" class="navigation-menu-button" id="js-mobile-menu">
      <i class="fa fa-bars"></i>
    </a>
    <nav role="navigation">
      <ul id="js-navigation-menu" class="navigation-menu show">
				
	

	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	
	<li class="nav-link"><a href="/gallery/">Gallery</a>
	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

<li class="nav-link"><a href="#" class="nav-link-contact">Contact</a></li>

      </ul>
    </nav>
  </div>
</header>


    <div class="page-content">
        <div class="post">

<div class="post-header-container has-cover" style="background-image: url(/assets/posts/2020-03-13-Jekyll-Blog/map_extension.png);">
  <div class="scrim has-cover ">
    <header class="post-header">
      <h1 class="title">Improving blogs with custom Jekyll Plugins</h1>
			
      <p class="info"><em>taking things to a higher level</em></p>
			
    </header>
  </div>
</div>

<div class="wrapper">



<section class="post-meta">
  <div class="post-date">Posted March 13, 2020 by Sebastian Proost</div>
  <div class="post-categories">
  in 
    
    <a href="/category/programming">Programming</a>
    
  
  </div>
</section>

<article class="post-content">
  <p>This blog is built using <a href="https://jekyllrb.com/">Jekyll</a>, which can be used to generate a static website based on a set of templates (for the
layout) and markdown files (for the content). The main advantage is that GitHub pages can be leveraged to host those
static pages for free. However, while there are plenty of great <a href="http://jekyllthemes.org/">themes</a> available, some features I really wanted are
usually not included. Fortunately, <a href="https://jekyllrb.com/">Jekyll</a> supports plugins to fill those gaps, here you’ll read about some plugins 
I made for this blog and <a href="http://beyond-the-known.eu/">Beyond the Known</a> (a travel blog).</p>

<h2 id="getting-started">Getting started</h2>

<p>For both blogs I’m involved in, the <a href="https://github.com/bencentra/centrarium">Centrarium</a> theme was used as a starting point. This theme already included many 
bits and pieces I wanted. There really isn’t any need to re-invent the wheel for every project. I did make a number of changes
to the theme, for instance I removed support for <a href="https://highlightjs.org/">HighlightJS</a> in favor for default code highlighter present in Jekyll.
I also prefer <a href="http://sachinchoolur.github.io/lightGallery/">LightGallery</a> over <a href="https://lokeshdhakar.com/projects/lightbox2/">Lightbox</a>, so I swapped that out as well.</p>

<p>These changes are pure html, js and css, you just need to pinpoint where the relevant code in the <code class="language-plaintext highlighter-rouge">_sass</code>, <code class="language-plaintext highlighter-rouge">_includes</code> or 
<code class="language-plaintext highlighter-rouge">_layouts</code> folder and make the change. However, I wanted a few more things that took a little bit more effort to
include.</p>

<h2 id="automatic-lightgallery-links-for-all-images">Automatic LightGallery links for all images</h2>

<p>In markdown you have a rather simple way to include an image.</p>

<div class="language-markdown highlighter-rouge"><div class="highlight"><pre class="highlight"><code> !<span class="p">[</span><span class="nv">image_description</span><span class="p">](</span><span class="sx">path/to/the/image.jpg</span><span class="p">)</span>
</code></pre></div></div>

<p>Technically, you should add the website’s baseurl to the path. This way the site will work also when hosted in a 
sub-directory. This can be done by adding <code class="language-plaintext highlighter-rouge">{{ site.baseurl }}/</code> before the path. This however is specific for the theme I started from and if you ever want to 
use the markdown files with another theme or,framework this will come back to haunt you… To include the image, with all the 
required features for LightGallery, you’ll have to resort to including pure html in your markdown file.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">"{{ site.baseurl }}/path/to/the/image.jpg"</span> <span class="na">class=</span><span class="s">"lightgallery-link"</span> <span class="na">data-sub-html=</span><span class="s">"image_description"</span><span class="nt">&gt;</span>
<span class="nt">&lt;img</span> <span class="na">alt=</span><span class="s">"image_description"</span> <span class="na">data-src=</span><span class="s">"{{ site.baseurl }}/path/to/the/image.jpg"</span> <span class="na">src=</span><span class="s">"{{ site.baseurl }}/path/to/the/image.jpg"</span> <span class="nt">/&gt;</span>
<span class="nt">&lt;/a&gt;</span>"
</code></pre></div></div>

<p>This is extremely verbose so adding a few images to a post will decrease the readability of the markdown. Furthermore,
the url needs to be repeated three times, the description twice. This irked me … a lot! I would like to use the basic
syntax in my markdown files, but convert this to the html when building the page. This can be done using a 
<strong>Jekyll Hook</strong>. Hooks are run before the file is parsed and they give you a spot to process the markdown files before
Jekyll parses them, here we’ll include a hook that converts everything for us automatically.</p>

<p>To do this a folder <code class="language-plaintext highlighter-rouge">_plugins</code> needs to be created in your project, and a file <code class="language-plaintext highlighter-rouge">lightgallery_links.rb</code> with the 
code below needs to be added.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="no">Jekyll</span><span class="o">::</span><span class="no">Hooks</span><span class="p">.</span><span class="nf">register</span> <span class="ss">:posts</span><span class="p">,</span> <span class="ss">:pre_render</span> <span class="k">do</span> <span class="o">|</span><span class="n">post</span><span class="p">,</span> <span class="n">payload</span><span class="o">|</span>
  <span class="n">post</span><span class="p">.</span><span class="nf">content</span><span class="p">.</span><span class="nf">gsub!</span><span class="p">(</span><span class="sr">/^!\[(.*)\]\(([^\)]+)\)((?:{:[^}]+})*)/</span><span class="p">,</span> <span class="s2">"&lt;a href=</span><span class="se">\"</span><span class="s2">{{ site.baseurl }}</span><span class="se">\\</span><span class="s2">2</span><span class="se">\"</span><span class="s2"> class=</span><span class="se">\"</span><span class="s2">lightgallery-link</span><span class="se">\"</span><span class="s2"> data-sub-html=</span><span class="se">\"\\</span><span class="s2">1</span><span class="se">\"</span><span class="s2">&gt;</span><span class="se">\n</span><span class="s2">![</span><span class="se">\\</span><span class="s2">1]({{ site.baseurl }}</span><span class="se">\\</span><span class="s2">2)</span><span class="se">\\</span><span class="s2">3{:data-src=</span><span class="se">\"</span><span class="s2">{{ site.baseurl }}</span><span class="se">\\</span><span class="s2">2</span><span class="se">\"</span><span class="s2">}</span><span class="se">\n</span><span class="s2">&lt;/a&gt;"</span><span class="p">)</span>
<span class="k">end</span>
</code></pre></div></div>

<p>The cryptic line is a regular expression that will detect image tags in standard markdown syntax, wrap them with the html
link tags and add a section to set the data-src of the image correctly. This will only be applied to images that are
defined at the start of the line, so it can still be disabled by simply putting a space in front of the image 
declaration.</p>

<h2 id="thumbnail-generator">Thumbnail generator</h2>

<p>Without pictures, the overview pages look rather dull, so adding a thumbnail there to grab the attention is a must.
As I will include a header image for each post, using the same image as the thumbnail is an option. However, the header
image is far larger than needed, so I wanted to automatically scale this down. Using a generator you can can create new
files using Ruby code, this can be used to create a low-resolution thumbnail for each header automatically.</p>

<p>First, we need to add the desired size of the thumbnails in the website’s <code class="language-plaintext highlighter-rouge">_config.yml</code>, as shown below. These
are parameters that will be passed to ImageMagik.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">plugins</span><span class="pi">:</span>
  <span class="c1"># Add Mini magick to the plugins</span>
  <span class="pi">-</span> <span class="s">mini_magick</span>

<span class="na">thumbnail</span><span class="pi">:</span>
    <span class="na">resize_dimensions</span><span class="pi">:</span> <span class="s1">'</span><span class="s">430x288^'</span>
    <span class="na">crop_dimensions</span><span class="pi">:</span> <span class="s1">'</span><span class="s">430x288+0+0'</span>
</code></pre></div></div>

<p>We’ll also need to add mini_magic to the <code class="language-plaintext highlighter-rouge">Gemfile</code>, it should look like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">source</span> <span class="s1">'https://rubygems.org'</span>
gem <span class="s1">'jekyll'</span>, <span class="s1">'&lt;4'</span>
gem <span class="s1">'jekyll-archives'</span>
gem <span class="s1">'jekyll-sitemap'</span>
gem <span class="s1">'jekyll-paginate-v2'</span>
gem <span class="s1">'mini_magick'</span>
</code></pre></div></div>

<p>We’ll have to add a path where to store the resized image in the header of each post. See the header of this post in the
example below, the cover needs to be defined, this is the input for the thumbnail generator and the thumbnail path is
the place where the resized image will be written to.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">layout</span><span class="pi">:</span> <span class="s">post</span>
<span class="na">title</span><span class="pi">:</span>  <span class="s2">"</span><span class="s">Jekyll</span><span class="nv"> </span><span class="s">Plugins"</span>
<span class="na">byline</span><span class="pi">:</span> <span class="s2">"</span><span class="s">lift</span><span class="nv"> </span><span class="s">your</span><span class="nv"> </span><span class="s">blog</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">a</span><span class="nv"> </span><span class="s">higher</span><span class="nv"> </span><span class="s">level"</span>
<span class="na">date</span><span class="pi">:</span>   <span class="s">2020-03-13 12:00:00</span>
<span class="na">author</span><span class="pi">:</span> <span class="s">Sebastian Proost</span>
<span class="na">categories</span><span class="pi">:</span> <span class="s">programming</span>
<span class="na">tags</span><span class="pi">:</span> <span class="s">ruby jekyll blog</span>
<span class="na">cover</span><span class="pi">:</span>  <span class="s2">"</span><span class="s">/assets/posts/2020-03-13-Jekyll-Blog/map_extension.png"</span>
<span class="na">thumbnail</span><span class="pi">:</span> <span class="s2">"</span><span class="s">/assets/images/thumbnails/jekyll_map.jpg"</span>
</code></pre></div></div>

<p>Finally, place a file <code class="language-plaintext highlighter-rouge">thumbnail_generator.rb</code> in the <code class="language-plaintext highlighter-rouge">_plugins</code> folder with the code below.</p>

<div class="language-ruby highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">require</span> <span class="s2">"mini_magick"</span>
<span class="kp">include</span> <span class="no">MiniMagick</span>

<span class="k">module</span> <span class="nn">Jekyll</span>
  <span class="k">class</span> <span class="nc">ThumbnailGenerator</span> <span class="o">&lt;</span> <span class="no">Generator</span>
    <span class="n">safe</span> <span class="kp">true</span>

    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="n">site</span><span class="p">)</span>
       <span class="n">posts</span> <span class="o">=</span> <span class="n">site</span><span class="p">.</span><span class="nf">posts</span><span class="p">.</span><span class="nf">docs</span><span class="p">.</span><span class="nf">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">post</span><span class="o">|</span> <span class="n">post</span><span class="p">.</span><span class="nf">data</span><span class="p">[</span><span class="s1">'thumbnail'</span><span class="p">]</span> <span class="p">}</span>
       <span class="n">resize_dimensions</span> <span class="o">=</span> <span class="no">Jekyll</span><span class="p">.</span><span class="nf">configuration</span><span class="p">({})[</span><span class="s1">'thumbnail'</span><span class="p">][</span><span class="s1">'resize_dimensions'</span><span class="p">]</span>
       <span class="n">crop_dimensions</span> <span class="o">=</span> <span class="no">Jekyll</span><span class="p">.</span><span class="nf">configuration</span><span class="p">({})[</span><span class="s1">'thumbnail'</span><span class="p">][</span><span class="s1">'crop_dimensions'</span><span class="p">]</span>
       <span class="n">posts</span><span class="p">.</span><span class="nf">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">post</span><span class="o">|</span>
         <span class="n">input_path</span> <span class="o">=</span> <span class="s2">".</span><span class="si">#{</span><span class="n">post</span><span class="p">[</span><span class="s1">'cover'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
         <span class="n">output_path</span> <span class="o">=</span> <span class="s2">".</span><span class="si">#{</span><span class="n">post</span><span class="p">[</span><span class="s1">'thumbnail'</span><span class="p">]</span><span class="si">}</span><span class="s2">"</span>
         <span class="k">if</span> <span class="o">!</span><span class="no">File</span><span class="p">.</span><span class="nf">exists?</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="o">||</span> <span class="no">File</span><span class="p">.</span><span class="nf">mtime</span><span class="p">(</span><span class="n">output_path</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="no">File</span><span class="p">.</span><span class="nf">mtime</span><span class="p">(</span><span class="n">input_path</span><span class="p">)</span>
            <span class="nb">puts</span><span class="p">(</span><span class="s2">"Generating thumbnail"</span><span class="p">,</span> <span class="n">input_path</span><span class="p">,</span> <span class="n">output_path</span><span class="p">)</span>
            <span class="n">image</span> <span class="o">=</span> <span class="no">MiniMagick</span><span class="o">::</span><span class="no">Image</span><span class="p">.</span><span class="nf">open</span><span class="p">(</span><span class="n">input_path</span><span class="p">)</span>
            <span class="n">image</span><span class="p">.</span><span class="nf">strip</span>
            <span class="n">image</span><span class="p">.</span><span class="nf">compress</span> <span class="s2">"JPEG2000"</span>
            <span class="n">image</span><span class="p">.</span><span class="nf">resize</span> <span class="n">resize_dimensions</span>
            <span class="n">image</span><span class="p">.</span><span class="nf">gravity</span> <span class="s2">"center"</span>
            <span class="n">image</span><span class="p">.</span><span class="nf">crop</span> <span class="n">crop_dimensions</span>
            <span class="n">image</span><span class="p">.</span><span class="nf">write</span> <span class="n">output_path</span>
         <span class="k">end</span>
      <span class="k">end</span>
    <span class="k">end</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre></div></div>

<p>This will select all posts with a thumbnail path defined and load the dimensions from the configuration. Then it will
iterate over the selected posts, resize the header to the desired size and write the output to the thumbnail path. 
to avoid unnecessarily resizing images over and over it will check if the thumbnail exists and the input file isn’t 
newer than the thumbnail.</p>

<p>Finally, the image needs to be included in the posts overview, but this is as trivial as getting the post’s title !</p>

<p>Using the same approach, I also built the <a href="/gallery/">gallery</a>.</p>

<h2 id="posts-on-a-world-map">Posts on a world map</h2>

<p>For <a href="http://beyond-the-known.eu/">Beyond the Known</a> we really wanted to include a world map with pins for each location a post was written about.
To do this, the GPS coordinates for each post need to be defined in the yaml header. These can easily be obtained from
google maps, and need to be included in the header of the post as shown here:</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="na">coords</span><span class="pi">:</span>
  <span class="na">lat</span><span class="pi">:</span> <span class="m">51.151706</span>
  <span class="na">lng</span><span class="pi">:</span> <span class="m">3.8708973</span>
</code></pre></div></div>

<p>A Google Maps API key needs to be obtained from <a href="https://console.developers.google.com/">Google Developer Console</a> and defined in the <code class="language-plaintext highlighter-rouge">_config.yml</code> file. 
Make sure to set the appropriate restrictions on your key!</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Google maps API key</span>
<span class="na">google_maps_api_key</span><span class="pi">:</span> <span class="s2">"</span><span class="s">your</span><span class="nv"> </span><span class="s">key</span><span class="nv"> </span><span class="s">here"</span>
</code></pre></div></div>

<p>Next, we need a json file that contains for each post: the coordinates, the title, the link and the
description. We’ll grab that file later when the actual map is generated. To do this create a file <code class="language-plaintext highlighter-rouge">map_data.json</code> in the
main folder of the website with this code:</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">---</span>
<span class="nx">layout</span><span class="p">:</span> <span class="kc">null</span>
<span class="o">---</span>

<span class="p">[</span>
<span class="p">{</span><span class="o">%</span> <span class="k">for</span> <span class="nx">post</span> <span class="k">in</span> <span class="nx">site</span><span class="p">.</span><span class="nx">posts</span> <span class="o">%</span><span class="p">}</span> 
<span class="p">{</span>
  <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">{{ post.title }}</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">url</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">{{ post.url | prepend: site.base }}</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">date</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">{{ post.date | date: </span><span class="dl">"</span> <span class="o">%</span> <span class="nx">B</span> <span class="o">%</span> <span class="nx">d</span><span class="p">,</span> <span class="o">%</span> <span class="nx">Y</span> <span class="dl">"</span><span class="s2"> }}</span><span class="dl">"</span><span class="p">,</span>
  <span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">{{ post.content | strip_html | smartify | truncatewords: 50 }}</span><span class="dl">"</span> <span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">post</span><span class="p">.</span><span class="nx">coords</span> <span class="o">%</span><span class="p">},</span>
  <span class="dl">"</span><span class="s2">coords</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
    <span class="dl">"</span><span class="s2">lat</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="p">{</span>
        <span class="nx">post</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">lat</span>
      <span class="p">}</span>
    <span class="p">},</span>
    <span class="dl">"</span><span class="s2">lng</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
      <span class="p">{</span>
        <span class="nx">post</span><span class="p">.</span><span class="nx">coords</span><span class="p">.</span><span class="nx">lng</span>
      <span class="p">}</span>
    <span class="p">}</span>
  <span class="p">}</span> <span class="p">{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span>
<span class="p">}</span> 
<span class="p">{</span><span class="o">%</span> <span class="k">if</span> <span class="nx">forloop</span><span class="p">.</span><span class="nx">last</span> <span class="o">%</span><span class="p">}</span> <span class="p">{</span><span class="o">%</span> <span class="k">else</span> <span class="o">%</span><span class="p">},</span> <span class="p">{</span><span class="o">%</span> <span class="nx">endif</span> <span class="o">%</span><span class="p">}</span> 
<span class="p">{</span><span class="o">%</span> <span class="nx">endfor</span> <span class="o">%</span><span class="p">}</span>
<span class="p">]</span>
</code></pre></div></div>

<p>Now we can include a map on a page using the code below. This will include JQuery to load the data in <code class="language-plaintext highlighter-rouge">map_data.json</code> 
(which is build from the coordinates in the
posts’ headers), these will be converted to markers on the map (complete with a popup menu) and together with the map
added to the div with <code class="language-plaintext highlighter-rouge">id="map"</code>.</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"map"</span><span class="nt">&gt;&lt;/div&gt;</span>
<span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"map_spacer"</span><span class="nt">&gt;&lt;/div&gt;</span>

<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://code.jquery.com/jquery-3.4.1.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;script&gt;</span>
	<span class="kd">var</span> <span class="nx">map</span><span class="p">;</span>
	<span class="kd">function</span> <span class="nx">initMap</span><span class="p">()</span> <span class="p">{</span>
		<span class="nx">map</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nb">Map</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="dl">'</span><span class="s1">map</span><span class="dl">'</span><span class="p">),</span> <span class="p">{</span>
			<span class="na">center</span><span class="p">:</span> <span class="p">{</span><span class="na">lat</span><span class="p">:</span> <span class="mf">50.8798</span><span class="p">,</span> <span class="na">lng</span><span class="p">:</span> <span class="mf">4.7005</span><span class="p">},</span>
			<span class="na">zoom</span><span class="p">:</span> <span class="mi">2</span>
		<span class="p">});</span>

		<span class="kd">function</span> <span class="nx">addMarker</span><span class="p">(</span><span class="nx">props</span><span class="p">)</span> <span class="p">{</span>
			<span class="kd">var</span> <span class="nx">marker</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">Marker</span><span class="p">({</span>
				<span class="na">position</span><span class="p">:</span> <span class="nx">props</span><span class="p">.</span><span class="nx">coords</span><span class="p">,</span>
				<span class="na">map</span><span class="p">:</span> <span class="nx">map</span>
			<span class="p">});</span>

			<span class="kd">var</span> <span class="nx">infoWindow</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">google</span><span class="p">.</span><span class="nx">maps</span><span class="p">.</span><span class="nx">InfoWindow</span><span class="p">({</span>
				<span class="na">content</span><span class="p">:</span> <span class="dl">'</span><span class="s1">&lt;h2&gt;&lt;a href="</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">props</span><span class="p">.</span><span class="nx">url</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">"&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">props</span><span class="p">.</span><span class="nx">title</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/a&gt;&lt;/h2&gt;&lt;p class="map_info_window"&gt;</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">props</span><span class="p">.</span><span class="nx">content</span> <span class="o">+</span> <span class="dl">'</span><span class="s1">&lt;/p&gt;</span><span class="dl">'</span>
			<span class="p">});</span>

			<span class="nx">marker</span><span class="p">.</span><span class="nx">addListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">click</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span><span class="p">()</span> <span class="p">{</span>
				<span class="nx">infoWindow</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="nx">map</span><span class="p">,</span> <span class="nx">marker</span><span class="p">);</span>
			<span class="p">});</span>

		<span class="p">}</span>

		<span class="nx">$</span><span class="p">.</span><span class="nx">getJSON</span><span class="p">(</span> <span class="dl">"</span><span class="s2">/map_data.json</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span> <span class="nx">data</span> <span class="p">)</span> <span class="p">{</span>
			<span class="nx">data</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">el</span><span class="p">){</span>
			  <span class="k">if</span> <span class="p">(</span><span class="k">typeof</span> <span class="nx">el</span><span class="p">.</span><span class="nx">coords</span> <span class="o">!==</span> <span class="dl">'</span><span class="s1">undefined</span><span class="dl">'</span><span class="p">)</span> <span class="p">{</span>
			    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
				  <span class="nx">addMarker</span><span class="p">(</span><span class="nx">el</span><span class="p">);</span>
				<span class="p">}</span>
			<span class="p">})</span>
		<span class="p">});</span>

	<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://maps.googleapis.com/maps/api/js?key=&amp;callback=initMap"</span> <span class="na">async</span> <span class="na">defer</span><span class="nt">&gt;&lt;/script&gt;</span>
</code></pre></div></div>

<p>To make the map show up, a little CSS is needed. Here is what works for our needs but will likely need to be adjusted 
to match your site’s design. It is important to define a height and width, otherwise the map won’t show.</p>

<div class="language-css highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">#map</span> <span class="p">{</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">90vh</span><span class="p">;</span>
    <span class="nl">min-height</span><span class="p">:</span> <span class="m">250px</span><span class="p">;</span>
    <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
    <span class="nl">position</span><span class="p">:</span> <span class="nb">absolute</span><span class="p">;</span>
    <span class="nl">width</span><span class="p">:</span> <span class="m">100%</span><span class="p">;</span>
    <span class="nl">left</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nf">#map_spacer</span> <span class="p">{</span>
    <span class="nl">height</span><span class="p">:</span> <span class="m">90vh</span><span class="p">;</span>
    <span class="nl">min-height</span><span class="p">:</span> <span class="m">250px</span><span class="p">;</span>
    <span class="nl">margin</span><span class="p">:</span> <span class="m">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="nt">p</span><span class="nc">.map_info_window</span> <span class="p">{</span>
	<span class="nl">width</span><span class="p">:</span> <span class="m">350px</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p><a href="/assets/posts/2020-03-13-Jekyll-Blog/map_extension.png" class="lightgallery-link" data-sub-html="Map page from Beyond-the-Known, with pins that can be clicked to jump to the relevant post">
<img src="/assets/posts/2020-03-13-Jekyll-Blog/map_extension.png" alt="Map page from Beyond-the-Known, with pins that can be clicked to jump to the relevant post" data-src="/assets/posts/2020-03-13-Jekyll-Blog/map_extension.png" loading="lazy" />
</a></p>

<p>The final result on <a href="http://beyond-the-known.eu/">Beyond the Known</a>. Note that I also included a custom style (have a look at the Google Maps Javascript API documentation
for details how to do that). This overview allows you to quickly find a relevant post about a region you’d might 
like to visit! Very useful feature for a travel blog.</p>

<h2 id="conclusion">Conclusion</h2>

<p>Using these plugins I was able to include all functionality I needed for this blog and <a href="http://beyond-the-known.eu/">Beyond the Known</a>. Generating
a static website has certain restrictions and it has been an adjustment to work with an opinionated framework like 
<a href="https://jekyllrb.com/">Jekyll</a>. However, now everything is in place there is one, consistent way to do things. This will make
maintaining both blogs a lot easier in the future. Static sites are also cheap to host, GitHub offers free hosting, the
only cost to run is the domain name which, at &lt; $10 per year, is negligible. This frees up some time and money that can
be put towards generating content!</p>

<p>If you have a blog, feel free to grab the code here to include these features in your website.</p>


</article>



<section class="tags">
	<strong><i class="fa fa-tags"></i> Tags:</strong> <a href="/tag/ruby">ruby</a>,&nbsp;<a href="/tag/jekyll">jekyll</a>,&nbsp;<a href="/tag/blog">blog</a>
</section>



<section class="rss">
  <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
</section>

<section class="share">
  <span>Share: </span>
  
    
    
      <a href="//twitter.com/share?text=Improving+blogs+with+custom+Jekyll+Plugins&url=https%3A%2F%2Fblog.4dcu.be%2Fprogramming%2F2020%2F03%2F13%2FJekyll-Blog.html&via=ProostSebastian"
        onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;">
        <i class="fa fa-twitter-square fa-lg"></i>
      </a>
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
    
    
    
    
    
  
    
    
    
      <a href="//www.facebook.com/sharer.php?t=Improving+blogs+with+custom+Jekyll+Plugins&u=https%3A%2F%2Fblog.4dcu.be%2Fprogramming%2F2020%2F03%2F13%2FJekyll-Blog.html"
        onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;">
        <i class="fa fa-facebook-square fa-lg"></i>
      </a>
    
    
    
    
    
    
  
    
    
    
    
    
      <a href="//www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fblog.4dcu.be%2Fprogramming%2F2020%2F03%2F13%2FJekyll-Blog.html"
        onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;">
        <i class="fa fa-linkedin-square fa-lg"></i>
      </a>
    
    
    
    
  
</section>

	<section class="post-navigation">
		<span class="prev-post">
			
				<a href="/diy/2020/02/25/3D-printing.html">
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-left fa-stack-1x fa-inverse"></i>
					</span>
					<span class="page-number">3D Printing Tips & Tricks</span>
				</a>
			
		</span>
		<span class="next-post">
			
				<a href="/programming/games/2020/04/05/DeckLock.html">
					<span class="page-number">DeckLock: keep track of your card games</span>
					<span class="fa-stack fa-lg">
						<i class="fa fa-square fa-stack-2x"></i>
						<i class="fa fa-angle-double-right fa-stack-1x fa-inverse"></i>
					</span>
				</a>
			
		</span>
	</section>




<section class="disqus">
  <div id="disqus_thread"></div>
  <script type="text/javascript">
    var disqus_shortname = '4dcube';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>



</div>
</div>

    </div>

		<div class="modal micromodal-slide" id="modal-1" aria-hidden="true">
	<div class="modal__overlay" tabindex="-1" data-micromodal-close>
		<div class="modal__container" role="dialog" aria-modal="true" aria-labelledby="modal-1-title">
			<header class="modal__header">
				<h2 class="modal__title" id="modal-1-title">
					Contact
				</h2>
			</header>
			<main class="modal__content" id="modal-1-content">
				<p>Have any comments or suggestions, your are welcome to reach out !</p>
				<ul class="modal__list">
						<li>
	<i class="fa fa-envelope-o"></i>
	<a href="mailto:sebastian.proost@gmail.com">
		<span class="username">sebastian.proost@gmail.com</span>
	</a>
</li>


	
	<li>
		<i class="fa fa-twitter"></i>
		<a href="https://twitter.com/ProostSebastian" title="Follow me on Twitter">
			<span class="username">ProostSebastian</span>
		</a>
	</li>
	

	
	<li>
		<i class="fa fa-github"></i>
		<a href="https://github.com/4dcu-be" title="Fork me on GitHub">
			<span class="username">4dcu-be</span>
		</a>
	</li>
	

	
	<li>
		<i class="fa fa-github"></i>
		<a href="https://github.com/sepro" title="Fork me on GitHub">
			<span class="username">sepro</span>
		</a>
	</li>
	

	

	


				</ul>
			</main>
			<footer class="modal__footer">
				<button class="modal__btn modal__btn-primary" data-micromodal-close="" aria-label="Close this dialog window">Close</button>
			</footer>
		</div>
	</div>
</div>


    <footer class="site-footer">

  <div class="wrapper">

    <h3 class="footer-heading">4DCu.be</h3>

    <div class="site-navigation">

      <p><strong>Site Map</strong></p>
      <ul class="pages">
				
	

	
	<li class="nav-link"><a href="/about/">About</a>
	

	

	
	<li class="nav-link"><a href="/gallery/">Gallery</a>
	

	

	
	<li class="nav-link"><a href="/posts/">Posts</a>
	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

<li class="nav-link"><a href="#" class="nav-link-contact">Contact</a></li>

      </ul>
    </div>

    <div class="site-contact">

      <p><strong>Contact</strong></p>
      <ul class="social-media-list">
        <li>
	<i class="fa fa-envelope-o"></i>
	<a href="mailto:sebastian.proost@gmail.com">
		<span class="username">sebastian.proost@gmail.com</span>
	</a>
</li>


	
	<li>
		<i class="fa fa-twitter"></i>
		<a href="https://twitter.com/ProostSebastian" title="Follow me on Twitter">
			<span class="username">ProostSebastian</span>
		</a>
	</li>
	

	
	<li>
		<i class="fa fa-github"></i>
		<a href="https://github.com/4dcu-be" title="Fork me on GitHub">
			<span class="username">4dcu-be</span>
		</a>
	</li>
	

	
	<li>
		<i class="fa fa-github"></i>
		<a href="https://github.com/sepro" title="Fork me on GitHub">
			<span class="username">sepro</span>
		</a>
	</li>
	

	

	


      </ul>
    </div>

    <div class="site-signature">
      <p class="rss-subscribe text"><strong>Subscribe <a href="/feed.xml">via RSS</a></strong></p>
      <p class="text">A blog about Programming (mostly in Python), Machine Learning, Gaming, Technology and more.</p>
			<p class="text">Last update: April 28, 2021</p>
    </div>

  </div>

</footer>

<!-- Scripts -->
<script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="/js/lightgallery.min.js"></script>
<script src="//unpkg.com/micromodal/dist/micromodal.min.js"></script>
<script src="https://unpkg.com/aos@next/dist/aos.js"></script>

<script>
	AOS.init({
   once: true,
   offset: -20,
   duration: 600
	});
</script>


<script type="text/javascript">
$(document).ready(function() {
  // Header
  var menuToggle = $('#js-mobile-menu').unbind();
  $('#js-navigation-menu').removeClass("show");
  menuToggle.on('click', function(e) {
    e.preventDefault();
    $('#js-navigation-menu').slideToggle(function(){
      if($('#js-navigation-menu').is(':hidden')) {
        $('#js-navigation-menu').removeAttr('style');
      }
    });
  });

});

</script>
<script type="text/javascript">
$(document).ready(function() {
		$(".post-content").lightGallery({
			 thumbnail:false,
			 selector: '.lightgallery-link'
		});
});
</script>

<!-- Contact Modal -->
<script type="text/javascript">
$(document).ready(function() {
	MicroModal.init();

	$('.nav-link-contact').click(function(ev) {
	  ev.preventDefault();
	  MicroModal.show('modal-1', {
	  		onClose: function() { $('.nav-link-contact').blur(); },
	  		disableFocus: true
	  });
	});

});
</script>





<!-- Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-47068418-5', 'auto');
  ga('send', 'pageview', {
    'page': '/programming/2020/03/13/Jekyll-Blog.html',
    'title': 'Improving blogs with custom Jekyll Plugins'
  });
</script>


  </body>

</html>
